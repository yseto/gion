function list(){$(".appendlist").remove(),jQuery.ajax({type:"POST",url:"/inf/get_targetlist",datatype:"json",success:function(a){$("#selectCat").empty(),jQuery.each(a.n,function(){var a=$("<tr>").attr("id","child_"+this.i).addClass("appendlist");a.append($("<td>").attr("colspan",2).append($("<button>").addClass("deletebtn btn btn-danger btn-xs").data("name",this.n).data("target","category").data("id",this.i).text("削除"))),a.append($("<th>").text(this.n)),$("#cat_list").append(a),$("#selectCat").append($("<option>").val(this.i).text(this.n))}),jQuery.each(a.t,function(){var a=$("<tr>").addClass("appendlist");a.append($("<td>").append($("<button>").addClass("deletebtn btn btn-danger btn-xs").data("name",this.n).data("target","entry").data("id",this.i).text("削除"))),a.append($("<td>").append($("<button>").addClass("categorybtn btn btn-info btn-xs").data("name",this.c).data("id",this.i).text("変更")));var b=this.n.substr(0,20);b!=this.n&&(b+="...");var c=$("<a>").addClass("btn btn-link btn-xs").attr({href:this.h,target:"blank",title:this.n}).append($("<span>").addClass("visible-xs").text(b)).append($("<span>").addClass("visible-sm visible-md visible-lg").text(this.n));(this.r<-5||404==this.r)&&(c.append($("<span>").addClass("badge ").text("取得に失敗しました")),a.addClass("danger")),a.append($("<td>").append(c)),$("#child_"+this.c).after(a)})}})}$(window).on("load",function(){jQuery.ajaxSetup({cache:!1,error:function(){$("#myModal").modal("show")}}),list()}),$(document).on("click","#change-categories",function(){jQuery.ajax({type:"POST",url:"/manage/change_it",data:{id:$("#target-id").val(),cat:$("#selectCat").val()},datatype:"json",success:function(){$("#categoriesModal").modal("hide"),list()}})}),$(document).on("click",".deletebtn",function(){confirm($(this).data("name")+" を削除しますか")&&jQuery.ajax({type:"POST",url:"/manage/delete_it",data:{target:$(this).data("target"),id:$(this).data("id")},datatype:"json",success:function(){list()}})}),$(document).on("click",".categorybtn",function(){$("#selectCat").val($(this).data("name")),$("#target-id").val($(this).data("id")),$("#categoriesModal").modal("show")});var nav=$(".nav");nav.on("click",'a[href="#home"]',function(){location.href="/"}),nav.on("click",'a[href="#entries"]',function(){location.href="/entries/"}),nav.on("click",'a[href="#addasite"]',function(){location.href="/add/"}),nav.on("click",'a[href="#subscription"]',function(){location.href="/subscription/"}),nav.on("click",'a[href="#settings"]',function(){location.href="/settings/"}),nav.on("click",'a[href="#logout"]',function(){location.href="/?logout=1"}),$("#helpmodal").click(function(){$("#helpModal").modal("show")}),$("#returntop").click(function(){$("html,body").animate({scrollTop:0},"fast")});